<HtmL>

<HEAD>
    <TITLE>webpage1</TITLE>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <Script>
        $(document).ready(function () {
            $.getJSON("./zonelist.json", function (obj) {
                $.each(obj.Zones, function (key, value) {
                    $("#dropDownZone").append('<option value="' + value.ZoneName + '">' + value.ZoneName + '</option>');
                });
            });

        });
    </Script>
</HEAD>

<BODY BGCOLOR="FFFFFf" LINK="006666" ALINK="8B4513" VLINK="006666">
    <TABLE WIDTH="75%" ALIGN="center">
        <TR>
            <TD>
                <DIV ALIGN="center">
                    <H1>Socket to zone level calculator </H1>
                </DIV>
                <DIV style="text-align:center">
                    <P>Please enter your difficulty</p>
                    <select id="difficulty" style="align-content: center;">
                        <option id="Normal">Normal</option>
                        <option id="Nightmare">Nightmare</option>
                        <option id="Hell">Hell</option>
                    </select>
                    <p>Please enter your current zone</p>
                    <select name="drop_down" id="dropDownZone">
                        <option value="None" selected="Selected">Select type</option>
                    </select>
                    <P>Please select your desired item base</P>
                    <select name="drop_down" id="dropDownItems">
                        <option value="None" selected="Selected">Select </option>
                        <option value="shie">Shield</option>
                        <option value="club">Club</option>
                        <option value="hamm">Hammer</option>
                        <option value="mace">Mace</option>
                        <option value="swor">Sword (One handed)</option>
                        <option value="staf">Staff</option>
                        <option value="bow">Bow</option>
                        <option value="h2h">Katar</option>
                        <option value="orb">Orb</option>
                        <option value="helm">Helmet</option>
                        <option value="tors">Body Armour</option>
                        <option value="axe">Axe</option>
                        <option value="scep">Scepter</option>
                        <option value="knif">Dagger</option>
                        <option value="pelt">Pelt</option>
                        <option value="phlm">Barbarian Helm</option>
                        <option value="ashd">Paladin Shield</option>
                        <option value="head">Necromancer Head</option>
                        <option value="spea">Spear</option>
                        <option value="pole">Polearm</option>
                        <option value="xbow">Crossbow</option>
                        <option value="wand">Wand</option>
                        <option value="aspe">Amazon Spear</option>
                        <option value="abow">Amazon Bow</option>
                    </select>
                    <br>
                    <button value="Submit" onclick="itemlistcalc()">Submit</button>
                    <br>
                    <div id="itemlist" style="white-space: pre-wrap"></div>
                </DIV>
            </TD>
        </TR>
    </TABLE>
</BODY>
<script>
    function itemlistcalc() {
        document.getElementById("itemlist").innerHTML = "empty";
        var zoneLevel = 0
        var dropDownZoneChoice = document.getElementById('dropDownZone').value;
        var difficultyChoice = document.getElementById('difficulty').value;
        var dropDownItemsChoice = document.getElementById('dropDownItems').value;
        $.getJSON("./zonelist.json", function (obj) {
            $.each(obj.Zones, function (key, value) {
                if (value.ZoneName == dropDownZoneChoice) {
                    if ("Normal" == difficultyChoice) {
                        zoneLevel = value.Normal;
                    }
                    if ("Nightmare" == difficultyChoice) {
                        zoneLevel = value.Nightmare;
                    }
                    if ("Hell" == difficultyChoice) {
                        zoneLevel = value.Hell;
                    }
                }
            });
        });
        var matchingitems = [];
        document.getElementById("itemlist").innerHTML = "";
        $.getJSON("./itemcategory.json", function (obj) {
            $.each(obj, function (key, value) {
                if (key <= zoneLevel) {
                    $.each(value, function (key, value) {
                        if ((key == dropDownItemsChoice)) {
                            matchingitems.push(value);
                        }
                    });
                }
            });
        });
        $.getJSON("./itemlist.json", function (obj) {
            if (zoneLevel < 26) {
                zoneLevel = "25";
            } else if (zoneLevel < 41) {
                zoneLevel = "40";
            } else {
                zoneLevel = "41";
            }
            matchingitems.forEach(function (entry) {
                $.each(obj.Itemlist, function (key, value) {
                    if (value.Item == entry) {
                        document.getElementById("itemlist").innerHTML += entry + " can currently drop. This can drop with maximum " + value[zoneLevel] + " sockets";
                        document.getElementById("itemlist").innerHTML += "\n";
                    }

                });
            });
        });
    }
</script>

</HTML>